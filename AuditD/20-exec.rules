## Monitor for use of audit management tools
-a always,exit -F arch=b64 -F arch=b64 -F path=/sbin/auditctl -F perm=x -k T1562_DefenseEvasion
-a always,exit -F arch=b64 -F arch=b64 -F path=/sbin/auditd -F perm=x -k audittools
-a always,exit -F arch=b64 -F arch=b64 -F path=/sbin/auditctl -F perm=x -k audittools
-a always,exit -F arch=b64 -F path=/sbin/auditd -F perm=x -k audittools
-a always,exit -F arch=b64 -F path=/usr/sbin/auditd -F perm=x -k audittools
-a always,exit -F arch=b64 -F path=/usr/sbin/augenrules -F perm=x -k audittools
-a always,exit -F arch=b64 -F path=/usr/sbin/ausearch -F perm=x -k audittools
-a always,exit -F arch=b64 -F path=/usr/sbin/aureport -F perm=x -k audittools
-a always,exit -F arch=b64 -F path=/usr/sbin/aulast -F perm=x -k audittools
-a always,exit -F arch=b64 -F path=/usr/sbin/aulastlogin -F perm=x -k audittools
-a always,exit -F arch=b64 -F path=/usr/sbin/auvirt -F perm=x -k audittools

## Kernel Related Events
-a always,exit -F arch=b64 -F perm=x -F auid!=-1 -F path=/sbin/insmod -k T1215_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F perm=x -F auid!=-1 -F path=/sbin/modprobe -k T1215_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F perm=x -F auid!=-1 -F path=/sbin/rmmod -k T1215_Kernel_Modules_and_Extensions

## Stunnel
-a always,exit -F arch=b64 -F path=/usr/sbin/stunnel -F perm=x -k T1079_Multilayer_Encryption
-a always,exit -F arch=b64 -F path=/usr/bin/stunnel -F perm=x -k T1079_Multilayer_Encryption

## Account Related Events
-a always,exit -F arch=b64 -F path=/usr/bin/passwd -F perm=x -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/groupadd -F perm=x -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/groupmod -F perm=x -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/addgroup -F perm=x -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/useradd -F perm=x -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/usermod -F perm=x -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/adduser -F perm=x -k T1078_Valid_Accounts

## Privileged Command Execution Related Events
-a always,exit -F arch=b64 -F path=/usr/sbin/userdel -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/ping -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/umount -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/mount -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/su -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/chgrp -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/ping6 -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/pam_timestamp_check -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/unix_chkpwd -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/pwck -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/suexec -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/usermod -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/newusers -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/groupdel -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/semanage -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/usernetctl -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/ccreds_validate -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/userhelper -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
##-a always,exit -F arch=b64 -F path=/usr/libexec/openssh/ssh-keysign -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/Xorg -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/rlogin -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/sudoedit -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/at -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/rsh -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/gpasswd -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/kgrantpty -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/crontab -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/sudo -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/staprun -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/rcp -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/passwd -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/chsh -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/chfn -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/chage -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/setfacl -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/chacl -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/chcon -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/newgrp -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/newrole -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/kpac_dhcp_helper -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts

## Priv Escalation Related Events
-a always,exit -F arch=b64 -F path=/bin/su -F perm=x -k T1169_Sudo
-a always,exit -F arch=b64 -F path=/usr/bin/sudo -F perm=x -k T1169_Sudo

## Recon Related Events
-a always,exit -F arch=b64 -F path=/usr/bin/whoami -F perm=x -k T1033_System_Owner_User_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/id -F perm=x -k T1033_System_Owner_User_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/hostname -F perm=x -k T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/uname -F perm=x -k T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/sbin/iptables -F perm=x -k T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/sbin/ip6tables -F perm=x -k T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/sbin/ifconfig -F perm=x -k T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/tcpdump -F perm=x -k T1049_System_Network_Connections_discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/traceroute -F perm=x -k T1049_System_Network_Connections_discovery
-a always,exit -F arch=b64 -F path=/usr/bin/wireshark -F perm=x -k T1049_System_Network_Connections_discovery
-a always,exit -F arch=b64 -F path=/usr/bin/rawshark -F perm=x -k T1049_System_Network_Connections_discovery
-a always,exit -F arch=b64 -F path=/usr/bin/grep -F perm=x -k T1081_Credentials_In_Files
-a always,exit -F arch=b64 -F path=/usr/bin/egrep -F perm=x -k T1081_Credentials_In_Files
-a always,exit -F arch=b64 -F path=/usr/bin/ps -F perm=x -k T1057_Process_Discovery

## Data Copy (Local)
-a always,exit -F arch=b64 -F path=/usr/bin/cp -F perm=x -k T1005_Data_from_Local_System
-a always,exit -F arch=b64 -F path=/usr/bin/dd -F perm=x -k T1005_Data_from_Local_System

## Remote Access Related Events
-a always,exit -F arch=b64 -F path=/usr/bin/wget -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/curl -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/base64 -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/nc -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/netcat -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ncat -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ss -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/netstat -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ssh -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/scp -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/sftp -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ftp -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/socat -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/rdesktop -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/nmap -F perm=x -k T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/arptables -F perm=x -k sbin_susp
-a always,exit -F arch=b64 -F path=/usr/sbin/ebtables -F perm=x -k sbin_susp
-a always,exit -F arch=b64 -F path=/sbin/xtables-nft-multi -F perm=x -k sbin_susp
-a always,exit -F arch=b64 -F path=/usr/sbin/nft -F perm=x -k sbin_susp

## Suspicious shells
-a always,exit -F arch=b64 -F path=/bin/ash -F perm=x -k susp_shell
-a always,exit -F arch=b64 -F path=/bin/csh -F perm=x -k susp_shell
-a always,exit -F arch=b64 -F path=/bin/fish -F perm=x -k susp_shell
-a always,exit -F arch=b64 -F path=/bin/tcsh -F perm=x -k susp_shell
-a always,exit -F arch=b64 -F path=/bin/tclsh -F perm=x -k susp_shell
-a always,exit -F arch=b64 -F path=/bin/xonsh -F perm=x -k susp_shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/xonsh -F perm=x -k susp_shell
-a always,exit -F arch=b64 -F path=/bin/open -F perm=x -k susp_shell
-a always,exit -F arch=b64 -F path=/bin/rbash -F perm=x -k susp_shell

## Package Manager
# RPM (Redhat-based)
-a always,exit -F arch=b64 -F path=/usr/bin/rpm -F perm=x -k T1072_third_party_software
-a always,exit -F arch=b64 -F path=/usr/bin/yum -F perm=x -k T1072_third_party_software

# DPKG / APT-GET (Debian-based)
-a always,exit -F arch=b64 -F path=/usr/bin/dpkg -F perm=x -k T1072_third_party_software
-a always,exit -F arch=b64 -F path=/usr/bin/apt-add-repository -F perm=x -k T1072_third_party_software
-a always,exit -F arch=b64 -F path=/usr/bin/apt-get -F perm=x -k T1072_third_party_software
-a always,exit -F arch=b64 -F path=/usr/bin/aptitude -F perm=x -k T1072_third_party_software

# Remote File Copy
-a always,exit -F arch=b64 -F path=/usr/bin/ftp -F perm=x -k T1105_remote_file_copy

## SELinux Related Events
-a always,exit -F arch=b64 -F path=/usr/sbin/setenforce -F perm=x -k T1562_DefenseEvasion
-a always,exit -F arch=b64 -F path=/usr/sbin/grubby -F perm=x -k T1562_DefenseEvasion
-a always,exit -F arch=b64 -F path=/usr/sbin/sestatus -F perm=x -k T1562_DefenseEvasion
-a always,exit -F arch=b64 -F path=/usr/sbin/semanage -F perm=x -k T1562_DefenseEvasion
-a always,exit -F arch=b64 -F path=/usr/sbin/load_policy -F perm=x -k T1562_DefenseEvasion
-a always,exit -F arch=b64 -F path=/usr/sbin/selinuxenabled -F perm=x -k T1562_DefenseEvasion
-a always,exit -F arch=b64 -F path=/usr/sbin/setfiles -F perm=x -k T1562_DefenseEvasion


## AppArmor Related Events
-a always,exit -F arch=b64 -F path=/usr/sbin/aa-disable -F perm=x -k T1562_DefenseEvasion
-a always,exit -F arch=b64 -F path=/usr/sbin/aa-complain -F perm=x -k T1562_DefenseEvasion
-a always,exit -F arch=b64 -F path=/usr/sbin/aa-teardown -F perm=x -k T1562_DefenseEvasion

# Systemd
-a always,exit -F arch=b64 -F path=/bin/systemctl -F perm=x -k systemd

### NFS mount
-a always,exit -F arch=b64 -F path=/sbin/mount.nfs -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/mount.nfs -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts

## Power state
-a always,exit -F arch=b64 -F path=/sbin/shutdown -F perm=x -k power
-a always,exit -F arch=b64 -F path=/sbin/poweroff -F perm=x -k power
-a always,exit -F arch=b64 -F path=/sbin/reboot -F perm=x -k power
-a always,exit -F arch=b64 -F path=/sbin/halt -F perm=x -k power

## sssd
-a always,exit -F arch=b64 -F path=/usr/libexec/sssd/p11_child -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/libexec/sssd/krb5_child -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/libexec/sssd/ldap_child -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/libexec/sssd/selinux_child -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/libexec/sssd/proxy_child -F perm=x -F auid>=500 -F auid!=4294967295 -k T1078_Valid_Accounts

## T1002 Data Compressed

-a always,exit -F arch=b64 -F path=/usr/bin/zip -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/bin/gzip -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/bin/tar -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/bin/bzip2 -F perm=x -k Data_Compressed

-a always,exit -F arch=b64 -F path=/usr/bin/lzip -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/local/bin/lzip -F perm=x -k Data_Compressed

-a always,exit -F arch=b64 -F path=/usr/bin/lz4 -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/local/bin/lz4 -F perm=x -k Data_Compressed

-a always,exit -F arch=b64 -F path=/usr/bin/lzop -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/local/bin/lzop -F perm=x -k Data_Compressed

-a always,exit -F arch=b64 -F path=/usr/bin/plzip -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/local/bin/plzip -F perm=x -k Data_Compressed

-a always,exit -F arch=b64 -F path=/usr/bin/pbzip2 -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/local/bin/pbzip2 -F perm=x -k Data_Compressed

-a always,exit -F arch=b64 -F path=/usr/bin/lbzip2 -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/local/bin/lbzip2 -F perm=x -k Data_Compressed

-a always,exit -F arch=b64 -F path=/usr/bin/pixz -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/local/bin/pixz -F perm=x -k Data_Compressed

-a always,exit -F arch=b64 -F path=/usr/bin/pigz -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/local/bin/pigz -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/bin/unpigz -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/local/bin/unpigz -F perm=x -k Data_Compressed

-a always,exit -F arch=b64 -F path=/usr/bin/zstd -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/local/bin/zstd -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F path=/usr/bin/gzexe -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F arch=b64 -F path=/usr/bin/gzexe -F perm=x -k Data_Compressed

-a always,exit -F arch=b64 -F path=/usr/sbin/gzexe -F perm=x -k Data_Compressed
-a always,exit -F arch=b64 -F arch=b64 -F path=/usr/sbin/gzexe -F perm=x -k Data_Compressed

## Docker
-a always,exit -F arch=b64 -F path=/usr/bin/dockerd -F perm=x -k docker
-a always,exit -F arch=b64 -F path=/usr/bin/docker -F perm=x -k docker
-a always,exit -F arch=b64 -F path=/usr/bin/docker-containerd -F perm=x -k docker
-a always,exit -F arch=b64 -F path=/usr/bin/docker-runc -F perm=x -k docker

## Kubelet
-a always,exit -F arch=b64 -F path=/usr/bin/kubelet -F perm=x -k kubelet

